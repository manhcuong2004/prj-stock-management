{% extends 'base.html' %}
{% load humanize %}
{% load static %}
{% block title %}
    T·ªïng quan
{% endblock %}
{% block extra_head %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
{% endblock %}

{% block content %}
<div class="container py-4 px-4">
    <!-- Ti√™u ƒë·ªÅ v√† b·ªô l·ªçc -->
    <div class="row justify-content-between align-items-center mb-4 g-3">
        <div class="col-12 col-md-auto">
            <h1 class="fs-3 fw-bold text-dark">üìä T·ªïng quan</h1>
        </div>
        <div class="col-12 col-md-auto d-flex flex-column flex-sm-row gap-2">
            <div class="position-relative flex-grow-1">
                <input type="text" id="dateRange" class="form-control rounded-3 px-4 py-2 shadow-sm" placeholder="Ch·ªçn kho·∫£ng th·ªùi gian">
            </div>
            <button id="filterBtn" class="btn btn-primary px-4 py-2 shadow-sm rounded-3">
                L·ªçc
            </button>
        </div>
    </div>

    <!-- Th·ªëng k√™ ch√≠nh -->
    <div class="row g-4">
        <!-- S·ªë ƒë∆°n h√†ng -->
        <div class="col-md-3 col-sm-6">
            <div class="card bg-light rounded-4 shadow-sm text-center p-4">
                <div class="text-muted">S·ªë ƒë∆°n h√†ng</div>
                <div class="fs-2 fw-bold text-primary my-2">{{ so_don_hang }}</div>
            </div>
        </div>

        <!-- Doanh thu -->
        <div class="col-md-3 col-sm-6">
            <div class="card bg-light rounded-4 shadow-sm text-center p-4">
                <div class="text-muted">Doanh thu</div>
                <div class="fs-2 fw-bold text-success my-2">{{ doanh_thu|intcomma }} ƒë</div>
            </div>
        </div>

        <!-- Gi√° tr·ªã nh·∫≠p kho -->
        <div class="col-md-3 col-sm-6">
            <div class="card bg-light rounded-4 shadow-sm text-center p-4">
                <div class="text-muted">Gi√° tr·ªã nh·∫≠p kho th√°ng n√†y</div>
                <div class="fs-2 fw-bold text-dark my-2">{{ gia_tri_nhap_kho|intcomma }} ƒë</div>
            </div>
        </div>

        <!-- Doanh thu xu·∫•t kho -->
        <div class="col-md-3 col-sm-6">
            <div class="card bg-light rounded-4 shadow-sm text-center p-4">
                <div class="text-muted">Doanh thu xu·∫•t kho th√°ng n√†y</div>
                <div class="fs-2 fw-bold text-dark my-2">{{ gia_tri_xuat_kho|intcomma }} ƒë</div>
            </div>
        </div>
    </div>

    <!-- N·ª£ -->
    <div class="row g-4 mt-4">
        <div class="col-md-6">
            <div class="card bg-white rounded-4 shadow p-4">
                <h5 class="fs-5 fw-semibold text-danger">N·ª£ ph·∫£i tr·∫£</h5>
                <div class="display-6 fw-bold mt-2 text-danger">{{ no_phai_tra|intcomma }} ƒë</div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card bg-white rounded-4 shadow p-4">
                <h5 class="fs-5 fw-semibold text-success">N·ª£ ph·∫£i thu</h5>
                <div class="display-6 fw-bold mt-2 text-success">{{ no_phai_thu|intcomma }} ƒë</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/vn.js"></script>

    <script>
        flatpickr("#dateRange", {
            mode: "range",
            dateFormat: "d/m/Y",
            locale: "vn",
            defaultDate: ["01/{{ today.month }}/{{ today.year }}", "{{ today.day }}/{{ today.month }}/{{ today.year }}"],
            maxDate: "today"
        });

        document.getElementById('filterBtn').addEventListener('click', function() {
            const dateRange = document.getElementById('dateRange').value;
            if (dateRange) {
                const dates = dateRange.split(" to ");
                const startDate = dates[0];
                const endDate = dates[1] || dates[0];

                // G·ª≠i y√™u c·∫ßu filter ƒë·∫øn server
                window.location.href = `?start_date=${startDate}&end_date=${endDate}`;
            }
        });
    </script>
{% endblock %}